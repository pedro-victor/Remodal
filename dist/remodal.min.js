/*
 *  Remodal - v1.0.5
 *  Responsive, lightweight, fast, synchronized with CSS animations, fully customizable modal window plugin with declarative configuration and hash tracking.
 *  http://vodkabears.github.io/remodal/
 *
 *  Made by Ilya Makarov
 *  Under MIT License
 */

!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(c){return b(a,c)}):"object"==typeof exports?b(a,require("jquery")):b(a,a.jQuery||a.Zepto)}(this,function(a,b){"use strict";function c(a){if(x&&"none"===a.css("animation-name")&&"none"===a.css("-webkit-animation-name")&&"none"===a.css("-moz-animation-name")&&"none"===a.css("-o-animation-name")&&"none"===a.css("-ms-animation-name"))return 0;var b,c,d,e,f=a.css("animation-duration")||a.css("-webkit-animation-duration")||a.css("-moz-animation-duration")||a.css("-o-animation-duration")||a.css("-ms-animation-duration")||"0s",g=a.css("animation-delay")||a.css("-webkit-animation-delay")||a.css("-moz-animation-delay")||a.css("-o-animation-delay")||a.css("-ms-animation-delay")||"0s",h=a.css("animation-iteration-count")||a.css("-webkit-animation-iteration-count")||a.css("-moz-animation-iteration-count")||a.css("-o-animation-iteration-count")||a.css("-ms-animation-iteration-count")||"1";for(f=f.split(", "),g=g.split(", "),h=h.split(", "),e=0,c=f.length,b=Number.NEGATIVE_INFINITY;e<c;e++)d=parseFloat(f[e])*parseInt(h[e],10)+parseFloat(g[e]),d>b&&(b=d);return d}function d(){if(b(document.body).height()<=b(window).height())return 0;var a,c,d=document.createElement("div"),e=document.createElement("div");return d.style.visibility="hidden",d.style.width="100px",document.body.appendChild(d),a=d.offsetWidth,d.style.overflow="scroll",e.style.width="100%",d.appendChild(e),c=e.offsetWidth,d.parentNode.removeChild(d),a-c}function e(){if(!y){var a,c,e=b("html"),f=k("is-locked");e.hasClass(f)||(c=b(document.body),a=parseInt(c.css("padding-right"),10)+d(),c.css("padding-right",a+"px"),e.addClass(f))}}function f(){if(!y){var a,c,e=b("html"),f=k("is-locked");e.hasClass(f)&&(c=b(document.body),a=parseInt(c.css("padding-right"),10)-d(),c.css("padding-right",a+"px"),e.removeClass(f))}}function g(a,b,c,d){var e=k("is",b),f=[k("is",v.CLOSING),k("is",v.OPENING),k("is",v.CLOSED),k("is",v.OPENED)].join(" ");a.$bg.removeClass(f).addClass(e),a.$overlay.removeClass(f).addClass(e),a.$wrapper.removeClass(f).addClass(e),a.$modal.removeClass(f).addClass(e),a.state=b,!c&&a.$modal.trigger({type:b,reason:d},[{reason:d}])}function h(a,d,e){var f=0,g=function(a){a.target===this&&f++},h=function(a){a.target===this&&0===--f&&(b.each(["$bg","$overlay","$wrapper","$modal"],function(a,b){e[b].off(s+" "+t)}),d())};b.each(["$bg","$overlay","$wrapper","$modal"],function(a,b){e[b].on(s,g).on(t,h)}),a(),0===c(e.$bg)&&0===c(e.$overlay)&&0===c(e.$wrapper)&&0===c(e.$modal)&&(b.each(["$bg","$overlay","$wrapper","$modal"],function(a,b){e[b].off(s+" "+t)}),d())}function i(a){a.state!==v.CLOSED&&(b.each(["$bg","$overlay","$wrapper","$modal"],function(b,c){a[c].off(s+" "+t)}),n(a),a.$bg.removeClass(a.settings.modifier),a.$overlay.removeClass(a.settings.modifier).hide(),a.$wrapper.hide(),0===z.length&&f(),g(a,v.CLOSED,!0))}function j(a){var b,c,d,e,f={};for(a=a.replace(/\s*:\s*/g,":").replace(/\s*,\s*/g,","),b=a.split(","),e=0,c=b.length;e<c;e++)b[e]=b[e].split(":"),d=b[e][1],("string"==typeof d||d instanceof String)&&(d="true"===d||"false"!==d&&d),("string"==typeof d||d instanceof String)&&(d=isNaN(d)?d:+d),f[b[e][0]]=d;return f}function k(){for(var a=r,b=0;b<arguments.length;++b)a+="-"+arguments[b];return a}function l(){var a,c,d=location.hash.replace("#",""),e=m();if(console.log("handleHashChangeEvent"),d){if(!e||e.id!==d){try{c=b('[data-remodal-id="'+d+'"]')}catch(f){}c&&c.length&&(a=b[q].lookup[c.data(q)],a&&a.settings.hashTracking&&a.open())}}else e&&e.state===v.OPENED&&e.settings.hashTracking&&e.close()}function m(){return z[z.length-1]}function n(a){var b=z.indexOf(a);b>=0&&z.splice(b,1)}function o(a,c){var d=b(document.body),e=this;e.id=a.attr("data-remodal-id"),e.settings=b.extend({},u,c),e.index=b[q].lookup.push(e)-1,e.state=v.CLOSED,e.$overlay||(e.$overlay=b("<div>").addClass(k("overlay")+" "+k("is",v.CLOSED)).hide(),d.append(e.$overlay)),e.$bg=b("."+k("bg")).addClass(k("is",v.CLOSED)),e.$modal=a.addClass(r+" "+k("is-initialized")+" "+e.settings.modifier+" "+k("is",v.CLOSED)).attr("tabindex","-1"),e.$wrapper=b("<div>").addClass(k("wrapper")+" "+e.settings.modifier+" "+k("is",v.CLOSED)).hide().append(e.$modal),d.append(e.$wrapper),e.$wrapper.on("click."+r,'[data-remodal-action="close"]',function(a){a.preventDefault(),e.close()}),e.$wrapper.on("click."+r,'[data-remodal-action="cancel"]',function(a){a.preventDefault(),e.$modal.trigger(w.CANCELLATION),e.settings.closeOnCancel&&e.close(w.CANCELLATION)}),e.$wrapper.on("click."+r,'[data-remodal-action="confirm"]',function(a){a.preventDefault(),e.$modal.trigger(w.CONFIRMATION),e.settings.closeOnConfirm&&e.close(w.CONFIRMATION)}),e.$wrapper.on("click."+r,function(a){var c=b(a.target);c.hasClass(k("wrapper"))&&e.settings.closeOnOutsideClick&&e.close()})}var p,q="remodal",r=a.REMODAL_GLOBALS&&a.REMODAL_GLOBALS.NAMESPACE||q,s=b.map(["animationstart","webkitAnimationStart","MSAnimationStart","oAnimationStart"],function(a){return a+"."+r}).join(" "),t=b.map(["animationend","webkitAnimationEnd","MSAnimationEnd","oAnimationEnd"],function(a){return a+"."+r}).join(" "),u=b.extend({hashTracking:!0,closeOnConfirm:!0,closeOnCancel:!0,closeOnEscape:!0,closeOnOutsideClick:!0,modifier:"",stack:!1},a.REMODAL_GLOBALS&&a.REMODAL_GLOBALS.DEFAULTS),v={CLOSING:"closing",CLOSED:"closed",OPENING:"opening",OPENED:"opened"},w={CONFIRMATION:"confirmation",CANCELLATION:"cancellation"},x=function(){var a=document.createElement("div").style;return void 0!==a.animationName||void 0!==a.WebkitAnimationName||void 0!==a.MozAnimationName||void 0!==a.msAnimationName||void 0!==a.OAnimationName}(),y=/iPad|iPhone|iPod/.test(navigator.platform),z=[];o.prototype.open=function(){var a,c,d=this;d.state!==v.OPENING&&d.state!==v.CLOSING&&(d.id&&d.settings.hashTracking&&(p=b(window).scrollTop(),location.hash=d.id),d.settings.stack||(a=m(),a&&a!==d&&i(a)),c=z.push(d),d.$overlay.css("z-index",function(a,b){return parseInt(b,10)+c}),d.$wrapper.css("z-index",function(a,b){return parseInt(b,10)+c}),e(),d.$bg.addClass(d.settings.modifier),d.$overlay.addClass(d.settings.modifier).show(),d.$wrapper.show().scrollTop(0),d.$modal.focus(),h(function(){g(d,v.OPENING)},function(){g(d,v.OPENED)},d))},o.prototype.close=function(a){var c,d=this;d.state!==v.OPENING&&d.state!==v.CLOSING&&(n(d),d.settings.hashTracking&&d.id===location.hash.substr(1)&&(c=m(),c?location.hash=c.id:(location.hash="",b(window).scrollTop(p))),h(function(){g(d,v.CLOSING,!1,a)},function(){d.$bg.removeClass(d.settings.modifier),d.$overlay.removeClass(d.settings.modifier).hide(),d.$wrapper.hide(),0===z.length&&f(),g(d,v.CLOSED,!1,a)},d))},o.prototype.getState=function(){return this.state},o.prototype.destroy=function(){var a,c=b[q].lookup;i(this),this.$wrapper.remove(),delete c[this.index],a=b.grep(c,function(a){return!!a}).length,0===a&&(this.$overlay.remove(),this.$bg.removeClass(k("is",v.CLOSING)+" "+k("is",v.OPENING)+" "+k("is",v.CLOSED)+" "+k("is",v.OPENED)))},b[q]={lookup:[]},b.fn[q]=function(a){var c,d;return this.each(function(e,f){d=b(f),null==d.data(q)?(c=new o(d,a),d.data(q,c.index),c.settings.hashTracking&&c.id===location.hash.substr(1)&&c.open()):c=b[q].lookup[d.data(q)]}),c},b(document).ready(function(){b(document).on("click","[data-remodal-target]",function(a){a.preventDefault();var c=a.currentTarget,d=c.getAttribute("data-remodal-target"),e=b('[data-remodal-id="'+d+'"]');b[q].lookup[e.data(q)].open()}),b(document).find("."+r).each(function(a,c){var d=b(c),e=d.data("remodal-options");e?("string"==typeof e||e instanceof String)&&(e=j(e)):e={},d[q](e)}),b(document).on("keydown."+r,function(a){var b=m();b&&b.settings.closeOnEscape&&b.state===v.OPENED&&27===a.keyCode&&b.close()}),b(window).on("hashchange."+r,l)})});